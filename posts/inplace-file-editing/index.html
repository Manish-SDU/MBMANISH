<!DOCTYPE html><html lang="en">
<!-- Mirrored from www.python-engineer.com/posts/inplace-file-editing/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Sep 2022 12:01:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head><meta charset="UTF-8"/><meta name="og:site_name" content="Python Engineer"/><link rel="canonical" href="https://python-engineer.com/posts/inplace-file-editing"/><meta name="twitter:url" content="https://python-engineer.com/posts/inplace-file-editing"/><meta name="og:url" content="https://python-engineer.com/posts/inplace-file-editing"/><title>In-place file editing with fileinput module | Python Engineer</title><meta name="twitter:title" content="In-place file editing with fileinput module | Python Engineer"/><meta name="og:title" content="In-place file editing with fileinput module | Python Engineer"/><meta name="description" content="This post shows how to edit one or more files in-place using the fileinput module."/><meta name="twitter:description" content="This post shows how to edit one or more files in-place using the fileinput module."/><meta name="og:description" content="This post shows how to edit one or more files in-place using the fileinput module."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="../../images/favicon.png" type="image/png"/><link rel="alternate" href="../../feed.rss" type="application/rss+xml" title="Subscribe to Python Engineer"/><meta name="twitter:image" content="../../images/icon.png"/><meta name="og:image" content="../../images/icon.png"/><script async defer data-domain="python-engineer.com" src="../../../plausible.io/js/plausible.js"></script></head><body class="item"><header><div class="header-promotion"><p><div class="wrapper"><p><a href="https://pythonengineer.pallet.com/" target="_blank">üêç Find Python and ML Jobs! üêç</a></p></div></p></div><div class="wrapper"><nav><ul><li class="selected"><a href="../index.html">POSTS</a></li><li><a href="../../courses/index.html">COURSES</a></li><li><a href="../../about/index.html">ABOUT</a></li></ul></nav><a href="../../index.html"><div class="hero-container"><img class="header-image-small" src="../../images/pat_face_bg.webp" alt="Patrick Loeber"/><div class="hero-text-container justify-center"><p>Become a</p><h1 class="colorized-text ">Python Engineer</h1><p class="mobile-hide">Come and learn about</p><ul class="mobile-hide"><li><a class="variant-a" href="../../tags/python/index.html">Python</a></li><li id="regular-li">and</li><li><a class="variant-b" href="../../tags/machine-learning/index.html">Machine Learning</a></li></ul></div></div></a></div></header><article class="page wrapper post-page"><h1 class="blog-header">In-place file editing with fileinput module</h1><div class="metadata"><ul class="tags"><li class="variant-a"><a href="../../tags/python/index.html">Python</a></li><li class="variant-a"><a href="../../tags/basics/index.html">Basics</a></li></ul><span class="post-date">10 Feb 2022, by </span><a class="author-link-post" href="../../authors/sundeep/index.html">Sundeep Agarwal</a></div><div class="content page-content"><p>Often, I have to make changes to existing files. For example, some software got updated, so I've to change version numbers. Or perhaps, I've changed the name of assets like input files, images, etc. If it's a single file, I'd likely just use my favorite text editor to open the file, make the changes and save it. If I have to edit multiple files, I'll write a Python script instead.</p><p>In this post, you'll learn how to use the <code>fileinput</code> module to make changes and update the original files.</p><h3>Documentation</h3><p>It is always a good idea to know where to find the documentation. Here's a quote from <a href="https://docs.python.org/3/library/fileinput.html">docs.python: fileinput</a>:</p><blockquote><p>This module implements a helper class and functions to quickly write a loop over standard input or a list of files. If you just want to read or write one file see <code>open()</code>.</p></blockquote><p>And here's the specific method you'll be learning to use in this post:</p><pre><code><div class="highlight"><span></span><span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span>
                <span class="n">openhook</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</div></code></pre><h3>Passing files as CLI arguments</h3><p>Assume you have two text files as shown below:</p><pre><code><div class="highlight"><span></span><span class="gp">$ </span>ls *.txt
<span class="go">notes.txt  tools.txt</span>

<span class="gp">$ </span>cat tools.txt
<span class="go">/home/learnbyexample/programs/command_help.sh</span>
<span class="go">/home/learnbyexample/bkp/calc.py</span>
<span class="go">/home/learnbyexample/programs/remove_duplicates.sh</span>
<span class="go">/home/learnbyexample/programs/calc.py</span>

<span class="gp">$ </span>cat notes.txt
<span class="go">Tool: /home/learnbyexample/programs/remove_duplicates.sh</span>
<span class="go">    * retains only first copy of duplicate lines</span>
<span class="go">    * maintains input order</span>
</div></code></pre><p>Suppose you changed your folder name from <code>programs</code> to <code>bin</code>, here's one way to update the above two text files using the <code>fileinput</code> module. By default, the <code>inplace</code> argument is <code>False</code>, so you have to set it to <code>True</code> when you want to write back the changes to the original files. The <code>print()</code> function is used to display the output text which will then be redirected to the original files by the <code>fileinput</code> module.</p><pre><code><div class="highlight"><span></span><span class="c1"># change_path.py</span>
<span class="kn">import</span> <span class="nn">fileinput</span>

<span class="k">with</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ip_line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">op_line</span> <span class="o">=</span> <span class="n">ip_line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/programs/&#39;</span><span class="p">,</span> <span class="s1">&#39;/bin/&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">op_line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</div></code></pre><p>Note that the input filenames aren't specified in the above program. Instead, you'll pass them as command line arguments as shown below:</p><pre><code><div class="highlight"><span></span><span class="gp">$ </span>python3 change_path.py *.txt

<span class="gp">$ </span>cat tools.txt
<span class="go">/home/learnbyexample/bin/command_help.sh</span>
<span class="go">/home/learnbyexample/bkp/calc.py</span>
<span class="go">/home/learnbyexample/bin/remove_duplicates.sh</span>
<span class="go">/home/learnbyexample/bin/calc.py</span>

<span class="gp">$ </span>cat notes.txt
<span class="go">Tool: /home/learnbyexample/bin/remove_duplicates.sh</span>
<span class="go">    * retains only first copy of duplicate lines</span>
<span class="go">    * maintains input order</span>
</div></code></pre><h3>stdin data</h3><p>If there's no file to process, <code>fileinput.input()</code> will automatically use <code>stdin</code> data. If <code>inplace</code> is set to <code>True</code>, it'll be ignored.</p><p>Here's an example to show how the program discussed in the previous section will work with <code>stdin</code> data:</p><pre><code><div class="highlight"><span></span><span class="gp">$ </span><span class="nb">echo</span> <span class="s1">&#39;/home/user/programs/create_venv.py&#39;</span> <span class="p">|</span> python3 change_path.py
<span class="go">/home/user/bin/create_venv.py</span>
</div></code></pre><h3>Passing list of files</h3><p>If you already know the files that have to be changed, you can pass them to the <code>files</code> argument. You can pass a single filename or an iterable of filenames.</p><pre><code><div class="highlight"><span></span><span class="c1"># file_list.py</span>
<span class="kn">import</span> <span class="nn">fileinput</span>

<span class="n">ip_files</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;notes.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;tools.txt&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="n">ip_files</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ip_line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">op_line</span> <span class="o">=</span> <span class="n">ip_line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/programs/&#39;</span><span class="p">,</span> <span class="s1">&#39;/bin/&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">op_line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</div></code></pre><p>Now that you've already specified the files to be modified, you just have to execute the program without any additional CLI arguments:</p><pre><code><div class="highlight"><span></span><span class="gp">$ </span>python3 file_list.py
</div></code></pre><p>Passing file arguments via CLI has the advantage of using shell features such as wildcard expansion. Python has various modules in case you need such features within the script itself. For example, you can use the <a href="https://docs.python.org/3/library/glob.html">glob module</a> for wildcard expansion.</p><h3>Backups</h3><p>Ideally, you should create backups of the files being modified so that you can recover original files if something goes wrong.</p><p>Assume you want to change <code>blue</code> to <code>brown</code> for the file shown below:</p><pre><code><div class="highlight"><span></span><span class="gp">$ </span>cat colors.txt
<span class="go">red blue green</span>
<span class="go">teal magenta</span>
<span class="go">dark-blue sea-green</span>
</div></code></pre><p>You can use the <code>backup</code> argument to create copies of the original files with the given extension.</p><pre><code><div class="highlight"><span></span><span class="c1"># inplace_with_backups.py</span>
<span class="kn">import</span> <span class="nn">fileinput</span>

<span class="k">with</span> <span class="n">fileinput</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">files</span><span class="o">=</span><span class="s1">&#39;colors.txt&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="s1">&#39;.orig&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ip_line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">op_line</span> <span class="o">=</span> <span class="n">ip_line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;brown&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">op_line</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</div></code></pre><p>After you execute the above program, you'll see that there's a copy of the original file.</p><pre><code><div class="highlight"><span></span><span class="gp">$ </span>python3 inplace_with_backups.py

<span class="gp"># </span>modified file
<span class="gp">$ </span>cat colors.txt
<span class="go">red brown green</span>
<span class="go">teal magenta</span>
<span class="go">dark-brown sea-green</span>

<span class="gp"># </span>copy of the original file
<span class="gp">$ </span>cat colors.txt.orig
<span class="go">red blue green</span>
<span class="go">teal magenta</span>
<span class="go">dark-blue sea-green</span>
</div></code></pre><p>Hope you found this post useful. Happy learning :)</p></div><ul class="actions"><li><a class="youtube-button" href="https://www.youtube.com/channel/UCbXgNpp0jedKWcQiULLbDTA?sub_confirmation=1" target="_blank" rel="nofollow">Subscribe</a></li><li><a class="twitter-button" href="https://twitter.com/intent/tweet?via=python_engineer&amp;text=In-place%20file%20editing%20with%20fileinput%20module&amp;url=https://python-engineer.com/posts/inplace-file-editing" rel="nofollow" target="_blank">Share</a></li></ul><div class="affiliate-container"><div><h2>FREE VS Code / PyCharm Extensions I Use</h2><p>‚úÖ Write cleaner code with Sourcery, instant refactoring suggestions: <a href="https://sourcery.ai/?utm_source=youtube&amp;utm_campaign=pythonengineer" target="_blank">Link *</a></p><p class="affiliate-note">* This is an affiliate link. By clicking on it you will not have any additional costs, instead you will support me and my project. Thank you! üôè</p></div></div><a class="sponsor-container" href="../../newsletter/index.html" rel="nofollow"><img class="main" src="../../images/numpyhandbook.webp" alt="newsletter"/><div><h2>FREE NumPy Handbook</h2><p>Learn NumPy with this eBook! It covers code examples for all essential functions. Get it for free together with monthly Python tips and news.</p><button class="pill-button">I Want This</button></div></a><div><div><a class="section-header pad-top" href="../../courses/index.html"><h2>Check out my Courses</h2></a><ul class="item-list grid"><li><article class="post-card"><a href="../../courses/tensorflowbeginner/index.html"><img class="post-thumb" alt="Thumbnail image of the post." src="../../images/titles/tfcourse.webp"/></a><ul class="tags"><li class="variant-a"><a href="../../tags/python/index.html">Python</a></li><li class="variant-f"><a href="../../tags/tensorflow/index.html">TensorFlow</a></li><li class="variant-c"><a href="../../tags/deep-learning/index.html">Deep Learning</a></li></ul><a class="post-link" href="../../courses/tensorflowbeginner/index.html"><h1 class="description">TensorFlow 2 Beginner</h1><p>Learn all the necessary basics to get started with TensorFlow 2 and Keras.</p></a></article></li><li><article class="post-card"><a href="../../courses/pytorchbeginner/index.html"><img class="post-thumb" alt="Thumbnail image of the post." src="../../images/titles/pytorchcourse.webp"/></a><ul class="tags"><li class="variant-a"><a href="../../tags/python/index.html">Python</a></li><li class="variant-c"><a href="../../tags/pytorch/index.html">PyTorch</a></li><li class="variant-c"><a href="../../tags/deep-learning/index.html">Deep Learning</a></li></ul><a class="post-link" href="../../courses/pytorchbeginner/index.html"><h1 class="description">PyTorch Beginner</h1><p>Learn all the necessary basics to get started with this deep learning framework.</p></a></article></li><li><article class="post-card"><a href="../../courses/mlfromscratch/index.html"><img class="post-thumb" alt="Thumbnail image of the post." src="../../images/titles/mlfromscratch.webp"/></a><ul class="tags"><li class="variant-a"><a href="../../tags/python/index.html">Python</a></li><li class="variant-b"><a href="../../tags/machine-learning/index.html">Machine Learning</a></li><li class="variant-d"><a href="../../tags/numpy/index.html">numpy</a></li></ul><a class="post-link" href="../../courses/mlfromscratch/index.html"><h1 class="description">ML From Scratch</h1><p>Implement popular Machine Learning algorithms from scratch using only built-in Python modules and numpy.</p></a></article></li><li><article class="post-card"><a href="../../courses/advancedpython/index.html"><img class="post-thumb" alt="Thumbnail image of the post." src="../../images/titles/advancedpythoncourse.webp"/></a><ul class="tags"><li class="variant-a"><a href="../../tags/python/index.html">Python</a></li></ul><a class="post-link" href="../../courses/advancedpython/index.html"><h1 class="description">Advanced Python</h1><p>Advanced Python Tutorials. It covers topics like collections, decorators, generators, multithreading, logging, and much more.</p></a></article></li></ul></div></div></article><footer><div class="wrapper patreon-footer"><h1>Patreon</h1><p>Become a Patron and get exclusive content! Get access to ML From Scratch notebooks, join a private Discord channel, get priority response, and more!</p><div class="gold-patrons"><h3>Special thanks to my Gold Patreons:</h3><p>Tonja J R</p><p>Daniel And Andy</p><p>Sergei</p></div><p>And of course thanks to every other member! I really appreciate the support!</p><a href="https://www.patreon.com/patrickloeber" target="_blank">Find Out More</a></div><div class="wrapper"><p>Copyright ¬© Python Engineer 2022.</p><p>Generated using <a href="https://github.com/johnsundell/publish" target="_blank">Publish</a>.</p><ul class="footer-links"><li><a class="youtube-button youtube-icon" href="https://www.youtube.com/channel/UCbXgNpp0jedKWcQiULLbDTA" target="_blank">YouTube</a></li><li><a class="social-button twitter-button" href="https://twitter.com/python_engineer" target="_blank">Twitter</a></li><li><a class="social-button github-button" href="https://github.com/python-engineer" target="_blank">GitHub</a></li><li><a class="social-button discord-button" href="https://discord.gg/FHMg9tKFSN" target="_blank">Discord</a></li><li><a class="footer-button" href="../../feed.rss">RSS</a></li><li><a class="footer-button" href="../../about/index.html">Contact</a></li><li><a class="footer-button" href="../../legal-notice/index.html">Legal Notice</a></li><li><a class="footer-button" href="../../privacy-policy/index.html">Privacy Policy</a></li></ul></div></footer></body>
<!-- Mirrored from www.python-engineer.com/posts/inplace-file-editing/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 04 Sep 2022 12:01:40 GMT -->
</html>